graph TD
    subgraph "ğŸ”€ Router Logic Decision Tree"
        A[ğŸ“ User Query Analysis] --> B{ğŸ¯ Intent Detection<br/>Semantic Analysis}
        B -->|Model Keywords| C[ğŸ” MODEL_SUGGESTION<br/>Triggers Detected]
        B -->|Research Keywords| D[ğŸ”¬ RESEARCH_PLANNING<br/>Triggers Detected]
        
        C --> C1[ğŸ“Š Confidence: High<br/>Architecture Query]
        D --> D1[ğŸ“Š Confidence: High<br/>Problem Discovery]
    end
    
    subgraph "ğŸ”„ Research Planning Conditional Logic"
        E[ğŸ¯ Problem Generation] --> F[âœ… Problem Validation]
        F --> G{ğŸ¤” Validation Decision<br/>_check_completion()}
        
        G -->|recommendation: accept| H[ğŸ“¥ Collect Problem<br/>Add to Validated List]
        G -->|recommendation: reject| I[ğŸ”„ Continue Generation<br/>Loop Back]
        
        H --> J{ğŸ“Š Collection Decision<br/>_should_continue_generating()}
        
        J -->|validated_problems < 3| K[ğŸ”„ Generate More<br/>Need Additional Problems]
        J -->|validated_problems >= 3| L[âœ… Finalize Plan<br/>Sufficient Problems]
        J -->|iteration_count >= 10| M[â° Force Finalize<br/>Max Iterations Reached]
        
        I --> E
        K --> E
        L --> N[ğŸ“‹ Create Research Plan]
        M --> N
    end
    
    subgraph "ğŸ¯ Validation Assessment Logic"
        O[ğŸ” Problem Analysis] --> P{ğŸ“Š Status Classification}
        
        P -->|Status: solved| Q[âŒ REJECT<br/>Well Established]
        P -->|Status: well_studied| R[âŒ REJECT<br/>Extensively Researched]
        P -->|Status: partially_solved| S{ğŸ¯ Confidence Check<br/>> 0.7?}
        P -->|Status: open| T[âœ… ACCEPT<br/>Novel Opportunity]
        
        S -->|Yes| U[âœ… ACCEPT<br/>Significant Gaps]
        S -->|No| V[âŒ REJECT<br/>Low Confidence]
    end
    
    subgraph "âš™ï¸ System Control Flow"
        W[ğŸš€ System Start] --> X[ğŸ¤– Initialize Router]
        X --> Y[ğŸ“ Process User Query]
        Y --> Z{ğŸ¯ Route Decision}
        Z -->|Model| AA[ğŸ“Š Execute Model Workflow]
        Z -->|Research| BB[ğŸ”¬ Execute Research Workflow]
        AA --> CC[ğŸ“¤ Return Model Results]
        BB --> DD[ğŸ“¤ Return Research Results]
        CC --> EE[ğŸ’¾ Save & Display Results]
        DD --> EE
    end
    
    %% Styling
    classDef router fill:#FFE4E1,stroke:#DC143C,stroke-width:2px
    classDef research fill:#E0F6FF,stroke:#0080FF,stroke-width:2px
    classDef validation fill:#F0FFF0,stroke:#32CD32,stroke-width:2px
    classDef control fill:#F5F5DC,stroke:#8B4513,stroke-width:2px
    classDef decision fill:#FFFACD,stroke:#DAA520,stroke-width:2px
    classDef accept fill:#98FB98,stroke:#228B22,stroke-width:2px
    classDef reject fill:#FFB6C1,stroke:#DC143C,stroke-width:2px
    classDef process fill:#E6E6FA,stroke:#9370DB,stroke-width:2px
    
    class A,B,C,D,C1,D1 router
    class E,F,H,I,J,K,L,M,N research
    class O,P,S validation
    class W,X,Y,Z,AA,BB,CC,DD,EE control
    class B,G,J,P,S,Z decision
    class T,U accept
    class Q,R,V reject
    class A,E,F,H,O,AA,BB,CC,DD,N process